{"job":{"components":{"4940":{"id":4940,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":496,"y":-16,"width":32,"height":32,"inputConnectorIDs":[4948],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create_view_prod_scd"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"VW_PROD_SCD_MAT"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Secure View","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"View Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4941":{"id":4941,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":368,"y":-16,"width":32,"height":32,"inputConnectorIDs":[4950],"outputConnectorIDs":[4948],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"calc_prod_stream"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IFF(\n\"STR_ACTION\"='INSERT' AND \"STR_UPDATE\" = TRUE AND\n  \"DIM_PROD_COST\" != \"PRODCOST\", 'U', \n  \nIFF(\"STR_ACTION\"='INSERT' AND \"STR_UPDATE\" = FALSE ,'I', \n\n    IFF(\"STR_ACTION\"='DELETE' AND \"STR_UPDATE\" = FALSE ,'D',\n        \n        IFF(\"STR_ACTION\"='INSERT' AND \"STR_UPDATE\" = TRUE AND\n  \"DIM_PROD_COST\" = \"PRODCOST\", 'N',''))))\n    \n\n"},"2":{"slot":2,"type":"STRING","value":"ACTION"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'9999-12-31 00:00:00.000'::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"EXPIRYTIME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"current_timestamp()"},"2":{"slot":2,"type":"STRING","value":"CURTIME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE"},"2":{"slot":2,"type":"STRING","value":"CURFLAG"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4942":{"id":4942,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-112,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[4946],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_PRODGROUPS"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_PRODGROUPS"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GROUP_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"GROUPNAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DIVISION"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4943":{"id":4943,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":176,"y":-16,"width":32,"height":32,"inputConnectorIDs":[4946,4947,4949],"outputConnectorIDs":[4950],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"join_prods_groups"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stream_products"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_PRODGROUPS"},"2":{"slot":2,"type":"STRING","value":"grp"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DM_PRODUCTS_SCD"},"2":{"slot":2,"type":"STRING","value":"dim"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"main\".\"GROUP_ID\"=\"grp\".\"GROUP_ID\""},"2":{"slot":2,"type":"STRING","value":"main_Inner_grp"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"main\".\"PRODUCT_ID\"=\"dim\".\"PRODUCT_ID\""},"2":{"slot":2,"type":"STRING","value":"main_Left_dim"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main.PRODUCT_ID"},"2":{"slot":2,"type":"STRING","value":"PRODUCT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"main.GROUP_ID"},"2":{"slot":2,"type":"STRING","value":"GROUP_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"main.PRODUCT"},"2":{"slot":2,"type":"STRING","value":"PRODUCT_DESC"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"main.PRODCOST"},"2":{"slot":2,"type":"STRING","value":"PRODCOST"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"main.UPDATE_TS"},"2":{"slot":2,"type":"STRING","value":"UPDATE_TS"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"grp.GROUPNAME"},"2":{"slot":2,"type":"STRING","value":"GROUP_DESC"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"grp.DIVISION"},"2":{"slot":2,"type":"STRING","value":"DIVISION"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"dim.PRODUCT_COST"},"2":{"slot":2,"type":"STRING","value":"DIM_PROD_COST"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"main.METADATA$ACTION"},"2":{"slot":2,"type":"STRING","value":"STR_ACTION"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"main.METADATA$ISUPDATE"},"2":{"slot":2,"type":"STRING","value":"STR_UPDATE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4944":{"id":4944,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":-684341771,"x":-16,"y":144,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[4949],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stream_products"}}}},"visible":true},"2":{"slot":2,"name":"Target Stream","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STR_PRODUCTS"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"GROUP_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PRODCOST"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE_TS"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"METADATA$ACTION"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"METADATA$ISUPDATE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4945":{"id":4945,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-96,"y":64,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[4947],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DM_PRODUCTS_SCD"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DM_PRODUCTS_SCD"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_COST"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"4946":{"id":4946,"sourceID":4942,"targetID":4943},"4947":{"id":4947,"sourceID":4945,"targetID":4943},"4948":{"id":4948,"sourceID":4941,"targetID":4940},"4949":{"id":4949,"sourceID":4944,"targetID":4943},"4950":{"id":4950,"sourceID":4943,"targetID":4941}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"test_SubJob_Products_SCD_02","description":"","type":"TRANSFORMATION","tag":"3e3ce9ca-9699-430b-8ac2-743a76ce5593"}}